<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MCZJU Web Map</title>
    <link rel="stylesheet" href="./index.css">
</head>
<body>
    <script>
        window.addEventListener('wheel', function(event) {
            if (event.ctrlKey) {
                event.preventDefault();
            }
            if (event.deltaY !== 0) {
                event.preventDefault();
            }
            if (event.shiftKey) {
                event.preventDefault();
            }
        }, { passive: false });
    </script>
    <div id="map">
        <div id="mapf1">
            <img src="background.png">
        </div>
        <div id="mapf2">
            <canvas id="area" width="6379" height="4762"></canvas>
            <script>
                var canvas = document.getElementById("area");
                var context = canvas.getContext("2d");
                //e01
                context.beginPath();
                context.moveTo(3795, 1067);
                context.lineTo(3891, 1009);
                context.lineTo(4259, 945);
                context.lineTo(4335, 1367);
                context.lineTo(3855, 1427);
                context.closePath();
                context.fillStyle = "rgba(255, 86, 255, 0.5)";
                context.strokeStyle = "rgba(255, 86, 255, 0.5)";
                context.fill();
                context.stroke();
                //e02
                context.beginPath();
                context.moveTo(4325, 1046);
                context.lineTo(4710, 980);
                context.lineTo(4766, 1289);
                context.lineTo(4385, 1354);
                context.closePath();
                context.fillStyle = "rgba(255, 86, 86, 0.5)";
                context.strokeStyle = "rgba(255, 86, 86, 0.5)";
                context.fill();
                context.stroke();
            </script>
        </div>
        <div id="mapf3">
            <button id="button-e01" class="area-button">E-1</button>
            <button id="button-e02" class="area-button">E-2</button>
            <script>
                document.getElementById("button-e01").addEventListener("click", function() {
                    this.classList.toggle("area-button-expanded");
                    if (this.classList.contains("area-button-expanded")) {
                        this.innerHTML = "E-1<br>承建人:xxx<br>完成度:xx%";
                    } else {
                        this.innerHTML = "E-1";
                    }
                });
                document.getElementById("button-e02").addEventListener("click", function() {
                    this.classList.toggle("area-button-expanded");
                    if (this.classList.contains("area-button-expanded")) {
                        this.innerHTML = "E-2<br>承建人:yyy<br>完成度:yy%";
                    } else {
                        this.innerHTML = "E-2";
                    }
                });
            </script>
        </div>
    </div>
    <div id="map-control">
        <button id="button-zoom-in" class="control-button" title="放大">+</button>
        <button id="button-zoom-out" class="control-button" title="缩小">-</button>
        <script>
            let scale = 1;
            const zoomInButton = document.getElementById('button-zoom-in');
            const zoomOutButton = document.getElementById('button-zoom-out');
            const mapElement = document.getElementById('map');
            function updateTransformOrigin() {
                const screenWidth = window.innerWidth;
                const screenHeight = window.innerHeight;
                mapElement.style.transformOrigin = `${screenWidth / 2}px ${screenHeight / 2}px`;
            }
            function zoomMap(delta) {
                scale = Math.min(Math.max(0.1, scale + delta), 3);
                updateTransformOrigin();
                mapElement.style.transform = `scale(${scale})`;
            }
            zoomInButton.addEventListener('click', () => {
                zoomMap(0.1);
            });
            zoomOutButton.addEventListener('click', () => {
                zoomMap(-0.1);
            });
            window.addEventListener('wheel', (event) => {
                event.preventDefault();
                const delta = event.deltaY < 0 ? 0.1 : -0.1;
                zoomMap(delta);
            });
            updateTransformOrigin();
        </script>
        <script>
            const map = document.getElementById('map');
            let isDragging = false;
            let offsetX, offsetY;
            document.addEventListener('mousedown', (e) => {
                if (e.target.tagName === 'BUTTON') return;
                isDragging = true;
                offsetX = e.clientX - map.getBoundingClientRect().left;
                offsetY = e.clientY - map.getBoundingClientRect().top;
            });
            document.addEventListener('mousemove', (e) => {
                if (isDragging) {
                    const targetElement = document.elementFromPoint(e.clientX, e.clientY);
                    if (targetElement && targetElement.tagName === 'BUTTON') {
                        return;
                    }
                    map.style.left = e.clientX - offsetX + 'px';
                    map.style.top = e.clientY - offsetY + 'px';
                }
            });
            document.addEventListener('mouseup', () => {
                isDragging = false;
            });
        </script>
    </div>
</body>
</html>